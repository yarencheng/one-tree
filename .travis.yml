dist: trusty
sudo: true

cache:
  directories:
    - $HOME/go

jobs:
  include:
    - stage: build
      script: |
        docker run -it --rm \
          --workdir /src \
          --volume $PWD/go-src:/src \
          --volume /go:/go \
          golang:1.12 \
          go build -v ./...

    - stage: test
      script: |
        docker run -it --rm \
          --workdir /src \
          --volume $PWD/go-src:/src \
          --volume /go:/go \
          golang:1.12 \
          go test -v ./...
